graph TB
    subgraph "SAML 2.0 Federation Architecture"
        User[ðŸ‘¤ User]
        Browser[ðŸŒ Browser]
        
        subgraph "Identity Provider (IdP)"
            IdP[ðŸ¢ Identity Provider]
            AuthEngine[ðŸ” Authentication Engine]
            AttrStore[ðŸ“‹ Attribute Store]
            SSOService[ðŸ”— SSO Service]
        end
        
        subgraph "Service Provider (SP)"
            SP[ðŸ“± Service Provider]
            ACS[ðŸ“¨ Assertion Consumer Service]
            SPApp[ðŸ–¥ï¸ Application]
        end
        
        subgraph "SAML Protocol Flow"
            AuthnReq[ðŸ“¤ AuthnRequest]
            SAMLResp[ðŸ“¨ SAML Response]
            Assertion[ðŸ“‹ SAML Assertion]
        end
    end
    
    subgraph "SAML Components"
        subgraph "Authentication Flows"
            SPInitiated[ðŸš€ SP-Initiated SSO]
            IdPInitiated[ðŸ¢ IdP-Initiated SSO]
            SLO[ðŸšª Single Logout]
        end
        
        subgraph "Security Features"
            DigitalSig[âœï¸ Digital Signatures]
            Encryption[ðŸ”’ XML Encryption]
            TimeBounds[â° Time Bounds]
            AudienceRestr[ðŸŽ¯ Audience Restriction]
        end
        
        subgraph "Assertion Types"
            AuthnAssertion[ðŸ” Authentication Assertion]
            AttrAssertion[ðŸ“‹ Attribute Assertion]
            AuthzAssertion[ðŸ›¡ï¸ Authorization Assertion]
        end
    end
    
    subgraph "Federation Scenarios"
        Enterprise[ðŸ¢ Enterprise SSO]
        Partner[ðŸ¤ Partner Federation]
        MultiDomain[ðŸŒ Multi-Domain SSO]
        B2B[ðŸ”— B2B Integration]
    end
    
    subgraph "Trust & Metadata"
        Metadata[ðŸ“‹ SAML Metadata]
        TrustRel[ðŸ¤ Trust Relationships]
        CertMgmt[ðŸ“œ Certificate Management]
        AttrMapping[ðŸ”„ Attribute Mapping]
    end
    
    %% Flow connections
    User --> Browser
    Browser --> SP
    SP --> AuthnReq
    AuthnReq --> IdP
    IdP --> AuthEngine
    AuthEngine --> AttrStore
    AttrStore --> SSOService
    SSOService --> SAMLResp
    SAMLResp --> Assertion
    Assertion --> ACS
    ACS --> SPApp
    SPApp --> User
    
    %% Component relationships
    SPInitiated --> AuthnReq
    IdPInitiated --> SAMLResp
    SLO --> IdP
    
    DigitalSig --> Assertion
    Encryption --> Assertion
    TimeBounds --> Assertion
    AudienceRestr --> Assertion
    
    AuthnAssertion --> Assertion
    AttrAssertion --> Assertion
    AuthzAssertion --> Assertion
    
    Enterprise --> IdP
    Partner --> TrustRel
    MultiDomain --> AttrMapping
    B2B --> Metadata
    
    %% Styling
    classDef userClass fill:#e1f5fe
    classDef idpClass fill:#f3e5f5
    classDef spClass fill:#e8f5e8
    classDef protocolClass fill:#fff3e0
    classDef securityClass fill:#ffebee
    classDef federationClass fill:#f1f8e9
    
    class User,Browser userClass
    class IdP,AuthEngine,AttrStore,SSOService idpClass
    class SP,ACS,SPApp spClass
    class AuthnReq,SAMLResp,Assertion protocolClass
    class DigitalSig,Encryption,TimeBounds,AudienceRestr securityClass
    class Enterprise,Partner,MultiDomain,B2B federationClass
